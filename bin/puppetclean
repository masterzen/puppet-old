#!/usr/bin/env ruby
# vim: softtabstop=4 shiftwidth=4 expandtab
#
# = Synopsis
#
# Fully clean a puppetmaster view of a host
#
# = Usage
#
#   puppetclean [-h|--help] [-d|--debug] [-v|--verbose] [-u|--unexport] host
#
# = Description
#
# This command cleans everything a puppetmaster knows about a node, including
# 
# * Signed certificates ($vardir/ssl/ca/signed/node.domain.pem)
# * Cached facts ($vardir/yaml/facts/node.domain.yaml)
# * Cached node stuff ($vardir/yaml/node/node.domain.yaml)
# * Reports ($vardir/reports/node.domain)
# * Stored configs: it can either remove all data from an host in your storedconfig
# database, or with --unexport turn every exported resource supporting ensure to absent
# so that any other host checking out their config can remove those exported configurations.
#
# = Options
#
# Note that any configuration parameter that's valid in the configuration file
# is also a valid long argument.  For example, 'ssldir' is a valid configuration
# parameter, so you can specify '--ssldir <directory>' as an argument.
#
# See the configuration file documentation at
# http://reductivelabs.com/projects/puppet/reference/configref.html for
# the full list of acceptable parameters. A commented list of all
# configuration options can also be generated by running puppet with
# '--genconfig'.
#
# debug::
#   Enable full debugging.
#
# help:
#   Print this help message.
#
# verbose::
#   Print extra information.
#
# unexport::
#   Instead of removing all the storedconfig data, it changes all exported resource's ensure parameter
#   of this host to "absent". Then it is necessary to wait that all other host have checked out their
#   configuration to run again puppetclean whithout this option to finish the clean-up.
#   
#
# = Example
#
# puppeclean some-random-host.reductivelabs.com
#
# = Author
#
# Brice Figureau
#
# = Copyright
#
# Copyright (c) 2005-2007 Reductive Labs, LLC
# Licensed under the GNU Public License

require 'puppet/application/puppetclean'
Puppet::Application[:puppetclean].run
